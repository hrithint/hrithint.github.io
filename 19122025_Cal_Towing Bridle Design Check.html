<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Towing Bridle Design Check Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }
        
        .container {
            max-width: 1400px;
            width: 100%;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            position: relative;
        }
        
        header {
            background: linear-gradient(135deg, #1a5f8c 0%, #2a6f98 100%);
            color: white;
            padding: 30px 25px;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            width: 200px;
            height: 200px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(30%, -30%);
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        h1 {
            font-size: 2.4rem;
            margin-bottom: 8px;
            font-weight: 600;
            letter-spacing: -0.5px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .credit {
            position: absolute;
            top: 25px;
            right: 25px;
            background: rgba(255, 255, 255, 0.15);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 2;
        }
        
        .tabs {
            display: flex;
            background: #f0f4f9;
            border-bottom: 1px solid #dce3ec;
        }
        
        .tab {
            padding: 18px 30px;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            color: #5a6c7d;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
            max-width: 300px;
        }
        
        .tab i {
            margin-right: 10px;
            font-size: 1.1rem;
        }
        
        .tab.active {
            color: #2a6f98;
            border-bottom: 3px solid #2a6f98;
            background: white;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
        }
        
        .tab-content.active {
            display: flex;
            flex-wrap: wrap;
        }
        
        .input-section {
            flex: 1;
            min-width: 350px;
            padding: 20px;
            border-right: 1px solid #eaeef2;
        }
        
        .output-section {
            flex: 2;
            min-width: 400px;
            padding: 20px;
        }
        
        .section-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #eaeef2;
            color: #2a6f98;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .input-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
            display: flex;
            align-items: center;
        }
        
        label i {
            margin-right: 8px;
            color: #2a6f98;
            width: 20px;
            text-align: center;
        }
        
        input[type="number"], select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background-color: #fafbfc;
        }
        
        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: #2a6f98;
            box-shadow: 0 0 0 3px rgba(42, 111, 152, 0.1);
            background-color: white;
        }
        
        .unit {
            color: #666;
            font-size: 0.9rem;
            margin-left: 5px;
            font-weight: normal;
        }
        
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.03);
            margin-bottom: 25px;
        }
        
        .result-table th, .result-table td {
            padding: 14px 15px;
            text-align: left;
            border-bottom: 1px solid #eaeef2;
        }
        
        .result-table th {
            background-color: #f8fafd;
            font-weight: 600;
            color: #2a6f98;
        }
        
        .result-table tr:last-child td {
            border-bottom: none;
        }
        
        .result-table tr:hover {
            background-color: #f8fafd;
        }
        
        .status {
            font-weight: bold;
            padding: 6px 12px;
            border-radius: 20px;
            display: inline-block;
            font-size: 0.85rem;
        }
        
        .status-ok {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        
        .status-fail {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .status-na {
            background-color: #f5f5f5;
            color: #666;
        }
        
        .check-title {
            display: flex;
            align-items: center;
            margin: 25px 0 15px 0;
            color: #2a6f98;
            font-size: 1.2rem;
        }
        
        .check-title i {
            margin-right: 10px;
            font-size: 1.1rem;
        }
        
        .sub-check-title {
            display: flex;
            align-items: center;
            margin: 20px 0 10px 0;
            color: #3a7bc8;
            font-size: 1.05rem;
        }
        
        .sub-check-title i {
            margin-right: 8px;
            font-size: 1rem;
        }
        
        .calc-button {
            background: linear-gradient(135deg, #2a6f98 0%, #1a5f8c 100%);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 25px auto;
            width: 200px;
        }
        
        .calc-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(42, 111, 152, 0.2);
        }
        
        .calc-button i {
            margin-right: 10px;
        }
        
        .input-row {
            display: flex;
            gap: 15px;
        }
        
        .input-row .input-group {
            flex: 1;
        }
        
        .diagram {
            text-align: center;
            margin: 25px 0;
            padding: 20px;
            background: #f8fafd;
            border-radius: 12px;
            border: 1px solid #eaeef2;
        }
        
        .diagram-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: #2a6f98;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .diagram-title i {
            margin-right: 10px;
        }
        
        .towing-diagram {
            width: 100%;
            max-width: 400px;
            height: 200px;
            background: linear-gradient(135deg, #f0f4f9 0%, #e4edf5 100%);
            border-radius: 8px;
            margin: 0 auto;
            position: relative;
            border: 1px solid #d1d9e6;
        }
        
        @media (max-width: 1024px) {
            .tab-content.active {
                flex-direction: column;
            }
            
            .input-section {
                border-right: none;
                border-bottom: 1px solid #eaeef2;
            }
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                max-width: 100%;
                padding: 15px;
                justify-content: flex-start;
            }
            
            .credit {
                position: relative;
                top: auto;
                right: auto;
                margin-top: 15px;
                display: inline-block;
            }
            
            header {
                text-align: center;
            }
            
            .input-row {
                flex-direction: column;
                gap: 0;
            }
        }
        
        .results-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .result-card {
            flex: 1;
            min-width: 300px;
            background: #f8fafd;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #eaeef2;
        }
        
        .result-card-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: #2a6f98;
            display: flex;
            align-items: center;
        }
        
        .result-card-title i {
            margin-right: 10px;
        }
        
        .result-item {
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #eaeef2;
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .input-group-check {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .input-group-check label {
            margin-bottom: 0;
            margin-left: 10px;
        }
        
        input[type="radio"] {
            margin-right: 5px;
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 5px;
        }
        
        .info-text {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>Towing Bridle Design Check Calculator</h1>
                <p class="subtitle">Based on DNV-ST-N001 Standards</p>
            </div>
            <div class="credit">Developed by Hrithin</div>
        </header>
        
        <div class="tabs">
            <div class="tab active" data-tab="input">
                <i class="fas fa-sliders-h"></i> Input Parameters
            </div>
            <div class="tab" data-tab="results">
                <i class="fas fa-clipboard-check"></i> Design Check Results
            </div>
        </div>
        
        <!-- Input Parameters Tab Content -->
        <div id="input-tab" class="tab-content active">
            <div class="input-section">
                <h2 class="section-title"><i class="fas fa-ship"></i> Towing Parameters</h2>
                
                <div class="input-group">
                    <label for="bollard-pull"><i class="fas fa-anchor"></i> Continuous static bollard pull of actual tug, BP <span class="unit">(MT)</span></label>
                    <input type="number" id="bollard-pull" value="50" step="0.1" min="0">
                </div>
                
                <div class="input-group">
                    <label><i class="fas fa-water"></i> Type of towage</label>
                    <div class="radio-group">
                        <div class="input-group-check">
                            <input type="radio" id="towage-benign" name="towage-type" value="Benign" checked>
                            <label for="towage-benign">Benign</label>
                        </div>
                        <div class="input-group-check">
                            <input type="radio" id="towage-normal" name="towage-type" value="Normal">
                            <label for="towage-normal">Normal</label>
                        </div>
                    </div>
                </div>
                
                <h2 class="section-title"><i class="fas fa-link"></i> Towline Properties</h2>
                
                <div class="input-group">
                    <label for="towline-mbl"><i class="fas fa-gem"></i> Towline MBL, TBL <span class="unit">(MT)</span></label>
                    <input type="number" id="towline-mbl" value="180" step="0.1" min="0">
                </div>
                
                <div class="input-group">
                    <label for="deployable-length"><i class="fas fa-ruler"></i> Deployable towline length (with pennant length), DTL <span class="unit">(m)</span></label>
                    <input type="number" id="deployable-length" value="700" step="1" min="0">
                </div>
                
                <h2 class="section-title"><i class="fas fa-cogs"></i> Towing Bridle Properties</h2>
                
                <div class="input-row">
                    <div class="input-group">
                        <label for="bridle-leg-mbl"><i class="fas fa-link"></i> MBL of towing bridle leg <span class="unit">(MT)</span></label>
                        <input type="number" id="bridle-leg-mbl" value="180" step="0.1" min="0">
                    </div>
                    
                    <div class="input-group">
                        <label for="chafe-chain-mbl"><i class="fas fa-link"></i> MBL of chafe chain <span class="unit">(MT)</span></label>
                        <input type="number" id="chafe-chain-mbl" value="180" step="0.1" min="0">
                    </div>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label for="bridle-angle"><i class="fas fa-angle-double-right"></i> Bridle apex angle <span class="unit">(deg)</span></label>
                        <input type="number" id="bridle-angle" value="60" step="1" min="0" max="180">
                    </div>
                    
                    <div class="input-group">
                        <label for="bridle-apex-mbl"><i class="fas fa-cube"></i> MBL of bridle apex <span class="unit">(MT)</span></label>
                        <input type="number" id="bridle-apex-mbl" value="180" step="0.1" min="0">
                    </div>
                </div>
                
                <h2 class="section-title"><i class="fas fa-compress-alt"></i> Intermediate Wire Pennant</h2>
                
                <div class="input-group">
                    <label for="pennant-mbl"><i class="fas fa-link"></i> MBL of intermediate wire pennant <span class="unit">(MT)</span></label>
                    <input type="number" id="pennant-mbl" value="180" step="0.1" min="0">
                </div>
                
                <div class="input-group">
                    <label><i class="fas fa-question-circle"></i> Is there any intermediate wire pennant?</label>
                    <div class="radio-group">
                        <div class="input-group-check">
                            <input type="radio" id="pennant-yes" name="pennant-present" value="Yes">
                            <label for="pennant-yes">Yes</label>
                        </div>
                        <div class="input-group-check">
                            <input type="radio" id="pennant-no" name="pennant-present" value="No" checked>
                            <label for="pennant-no">No</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="output-section">
                <h2 class="section-title"><i class="fas fa-shield-alt"></i> Shackles & Connections</h2>
                
                <div class="input-row">
                    <div class="input-group">
                        <label for="towline-shackle-mbl"><i class="fas fa-shield-alt"></i> MBL of towline shackles <span class="unit">(MT)</span></label>
                        <input type="number" id="towline-shackle-mbl" value="200" step="0.1" min="0">
                    </div>
                    
                    <div class="input-group">
                        <label for="bridle-shackle-mbl"><i class="fas fa-shield-alt"></i> MBL of bridle shackles <span class="unit">(MT)</span></label>
                        <input type="number" id="bridle-shackle-mbl" value="240" step="0.1" min="0">
                    </div>
                </div>
                
                <h3 class="sub-check-title"><i class="fas fa-wind"></i> Tow Connections & Fairlead</h3>
                
                <div class="input-row">
                    <div class="input-group">
                        <label for="fairlead-mbl"><i class="fas fa-anchor"></i> MBL of fairlead <span class="unit">(MT)</span></label>
                        <input type="number" id="fairlead-mbl" value="200" step="0.1" min="0">
                    </div>
                    
                    <div class="input-group">
                        <label for="tow-connection-mbl"><i class="fas fa-link"></i> MBL of Tow Connection <span class="unit">(MT)</span></label>
                        <input type="number" id="tow-connection-mbl" value="200" step="0.1" min="0">
                    </div>
                </div>
                
                <h2 class="section-title"><i class="fas fa-life-ring"></i> Bridle Recovery Arrangement</h2>
                
                <div class="input-group">
                    <label for="bridle-weight"><i class="fas fa-weight-hanging"></i> Combined weight of bridle, delta plate, intermediate wires <span class="unit">(MT)</span></label>
                    <input type="number" id="bridle-weight" value="0.5" step="0.01" min="0">
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label for="recovery-winch"><i class="fas fa-wind"></i> Recovery winch capacity <span class="unit">(MT)</span></label>
                        <input type="number" id="recovery-winch" value="2" step="0.1" min="0">
                    </div>
                    
                    <div class="input-group">
                        <label for="recovery-wire-mbl"><i class="fas fa-link"></i> MBL of recovery wire <span class="unit">(MT)</span></label>
                        <input type="number" id="recovery-wire-mbl" value="10" step="0.1" min="0">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="recovery-shackle-mbl"><i class="fas fa-shield-alt"></i> MBL of recovery shackle <span class="unit">(MT)</span></label>
                    <input type="number" id="recovery-shackle-mbl" value="10" step="0.1" min="0">
                </div>
                
                <h2 class="section-title"><i class="fas fa-exclamation-triangle"></i> Emergency Towing Equipment</h2>
                
                <div class="input-row">
                    <div class="input-group">
                        <label for="emergency-fairlead-mbl"><i class="fas fa-anchor"></i> MBL of fairlead <span class="unit">(MT)</span></label>
                        <input type="number" id="emergency-fairlead-mbl" value="180" step="0.1" min="0">
                    </div>
                    
                    <div class="input-group">
                        <label for="emergency-connection-mbl"><i class="fas fa-link"></i> MBL of tow connection <span class="unit">(MT)</span></label>
                        <input type="number" id="emergency-connection-mbl" value="180" step="0.1" min="0">
                    </div>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label for="emergency-pennant-mbl"><i class="fas fa-link"></i> MBL of emergency pennant <span class="unit">(MT)</span></label>
                        <input type="number" id="emergency-pennant-mbl" value="180" step="0.1" min="0">
                    </div>
                    
                    <div class="input-group">
                        <label for="emergency-pennant-length"><i class="fas fa-ruler"></i> Length of emergency pennant <span class="unit">(m)</span></label>
                        <input type="number" id="emergency-pennant-length" value="85" step="1" min="0">
                    </div>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label for="extension-wire-mbl"><i class="fas fa-link"></i> MBL of extension wire, if present <span class="unit">(MT)</span></label>
                        <input type="number" id="extension-wire-mbl" value="30" step="0.1" min="0">
                    </div>
                    
                    <div class="input-group">
                        <label for="float-line-mbl"><i class="fas fa-water"></i> MBL of float line <span class="unit">(MT)</span></label>
                        <input type="number" id="float-line-mbl" value="30" step="0.1" min="0">
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="float-line-length"><i class="fas fa-ruler"></i> Length of float line <span class="unit">(m)</span></label>
                    <input type="number" id="float-line-length" value="80" step="1" min="0">
                </div>
                
                <div class="diagram">
                    <div class="diagram-title">
                        <i class="fas fa-project-diagram"></i> Towing Bridle Diagram
                    </div>
                    <div class="towing-diagram"></div>
                </div>
                
                <button class="calc-button" id="calculate-all">
                    <i class="fas fa-calculator"></i> Calculate All
                </button>
            </div>
        </div>
        
        <!-- Results Tab Content -->
        <div id="results-tab" class="tab-content">
            <div class="output-section">
                <h2 class="section-title"><i class="fas fa-clipboard-check"></i> Design Check Results</h2>
                
                <h3 class="check-title"><i class="fas fa-link"></i> Towline Check</h3>
                <table class="result-table">
                    <tr>
                        <th>Parameter</th>
                        <th>Required Value</th>
                        <th>Actual Value</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>Absolute minimum deployable towline length, ADL</td>
                        <td id="required-adl">0 m</td>
                        <td id="actual-adl">0 m</td>
                        <td><span id="adl-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required towline MBL</td>
                        <td id="required-towline-mbl">0 MT</td>
                        <td id="actual-towline-mbl">0 MT</td>
                        <td><span id="towline-mbl-status" class="status">-</span></td>
                    </tr>
                </table>
                
                <h3 class="check-title"><i class="fas fa-cogs"></i> Towing Bridle Check</h3>
                <table class="result-table">
                    <tr>
                        <th>Parameter</th>
                        <th>Required Value</th>
                        <th>Actual Value</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>Required MBL of towing bridle leg</td>
                        <td id="required-bridle-leg-mbl">0 MT</td>
                        <td id="actual-bridle-leg-mbl">0 MT</td>
                        <td><span id="bridle-leg-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required MBL of chafe chain</td>
                        <td id="required-chafe-chain-mbl">0 MT</td>
                        <td id="actual-chafe-chain-mbl">0 MT</td>
                        <td><span id="chafe-chain-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required MBL of bridle apex</td>
                        <td id="required-bridle-apex-mbl">0 MT</td>
                        <td id="actual-bridle-apex-mbl">0 MT</td>
                        <td><span id="bridle-apex-status" class="status">-</span></td>
                    </tr>
                </table>
                
                <h3 class="check-title"><i class="fas fa-compress-alt"></i> Intermediate Wire Pennant Check</h3>
                <table class="result-table">
                    <tr>
                        <th>Parameter</th>
                        <th>Required Value</th>
                        <th>Actual Value</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>Required MBL of intermediate pennant</td>
                        <td id="required-pennant-mbl">0 MT</td>
                        <td id="actual-pennant-mbl">0 MT</td>
                        <td><span id="pennant-status" class="status">-</span></td>
                    </tr>
                </table>
                
                <h3 class="check-title"><i class="fas fa-shield-alt"></i> Shackles Check</h3>
                <table class="result-table">
                    <tr>
                        <th>Parameter</th>
                        <th>Required Value</th>
                        <th>Actual Value</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>Required MBL of Towline shackles</td>
                        <td id="required-towline-shackle">0 MT</td>
                        <td id="actual-towline-shackle">0 MT</td>
                        <td><span id="towline-shackle-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required MBL of Bridle shackles</td>
                        <td id="required-bridle-shackle">0 MT</td>
                        <td id="actual-bridle-shackle">0 MT</td>
                        <td><span id="bridle-shackle-status" class="status">-</span></td>
                    </tr>
                </table>
                
                <h3 class="check-title"><i class="fas fa-anchor"></i> Towline Connections and Fairleads Check</h3>
                <table class="result-table">
                    <tr>
                        <th>Parameter</th>
                        <th>Required Value</th>
                        <th>Actual Value</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>Required MBL of fairlead</td>
                        <td id="required-fairlead-mbl">0 MT</td>
                        <td id="actual-fairlead-mbl">0 MT</td>
                        <td><span id="fairlead-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required MBL of smit brackets</td>
                        <td id="required-smit-brackets">0 MT</td>
                        <td id="actual-smit-brackets">0 MT</td>
                        <td><span id="smit-brackets-status" class="status">-</span></td>
                    </tr>
                </table>
                
                <h3 class="check-title"><i class="fas fa-life-ring"></i> Bridle Recovery Arrangement Check</h3>
                <table class="result-table">
                    <tr>
                        <th>Parameter</th>
                        <th>Required Value</th>
                        <th>Actual Value</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>Capacity of recovery winch</td>
                        <td id="required-recovery-winch">0 MT</td>
                        <td id="actual-recovery-winch">0 MT</td>
                        <td><span id="recovery-winch-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required MBL of recovery wire</td>
                        <td id="required-recovery-wire">0 MT</td>
                        <td id="actual-recovery-wire">0 MT</td>
                        <td><span id="recovery-wire-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required MBL of recovery shackle</td>
                        <td id="required-recovery-shackle">0 MT</td>
                        <td id="actual-recovery-shackle">0 MT</td>
                        <td><span id="recovery-shackle-status" class="status">-</span></td>
                    </tr>
                </table>
                
                <h3 class="check-title"><i class="fas fa-exclamation-triangle"></i> Emergency Towing Equipment Check</h3>
                <table class="result-table">
                    <tr>
                        <th>Parameter</th>
                        <th>Required Value</th>
                        <th>Actual Value</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>Required MBL of fairlead</td>
                        <td id="required-emergency-fairlead">0 MT</td>
                        <td id="actual-emergency-fairlead">0 MT</td>
                        <td><span id="emergency-fairlead-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required MBL of tow connection</td>
                        <td id="required-emergency-connection">0 MT</td>
                        <td id="actual-emergency-connection">0 MT</td>
                        <td><span id="emergency-connection-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required minimum length of emergency pennant</td>
                        <td id="required-emergency-pennant-length">0 m</td>
                        <td id="actual-emergency-pennant-length">0 m</td>
                        <td><span id="emergency-pennant-length-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required MBL of emergency pennant</td>
                        <td id="required-emergency-pennant-mbl">0 MT</td>
                        <td id="actual-emergency-pennant-mbl">0 MT</td>
                        <td><span id="emergency-pennant-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required MBL of extension wire</td>
                        <td id="required-extension-wire">0 MT</td>
                        <td id="actual-extension-wire">0 MT</td>
                        <td><span id="extension-wire-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required MBL of float line</td>
                        <td id="required-float-line">0 MT</td>
                        <td id="actual-float-line">0 MT</td>
                        <td><span id="float-line-status" class="status">-</span></td>
                    </tr>
                    <tr>
                        <td>Required length of float line</td>
                        <td id="required-float-line-length-range">75-90 m</td>
                        <td id="actual-float-line-length">0 m</td>
                        <td><span id="float-line-length-status" class="status">-</span></td>
                    </tr>
                </table>
                
                <div style="text-align: center; padding: 20px; background: #f8fafd; border-radius: 12px; margin-top: 30px;">
                    <h3 id="overall-status" style="color: #2e7d32;">All design checks are satisfactory</h3>
                    <p id="sumstatus" style="margin-top: 10px; color: #666;">All requirements meet DNV-ST-N001 standards</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs and content
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab
                tab.classList.add('active');
                
                // Show corresponding content
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
        
        // Calculate All button
        document.getElementById('calculate-all').addEventListener('click', calculateAll);
        
        // Add event listeners to all inputs
        document.querySelectorAll('#input-tab input[type="number"], #input-tab input[type="radio"]').forEach(input => {
            input.addEventListener('input', calculateAll);
            input.addEventListener('change', calculateAll);
        });
        
        // Initial calculation
        calculateAll();
        
        function calculateAll() {
            // Get input values
            const bollardPull = parseFloat(document.getElementById('bollard-pull').value) || 0;
            
            // Towage type
            const towageType = document.querySelector('input[name="towage-type"]:checked').value;
            
            const towlineMBL = parseFloat(document.getElementById('towline-mbl').value) || 0;
            const deployableLength = parseFloat(document.getElementById('deployable-length').value) || 0;
            
            const bridleLegMBL = parseFloat(document.getElementById('bridle-leg-mbl').value) || 0;
            const chafeChainMBL = parseFloat(document.getElementById('chafe-chain-mbl').value) || 0;
            const bridleApexMBL = parseFloat(document.getElementById('bridle-apex-mbl').value) || 0;
            
            const pennantMBL = parseFloat(document.getElementById('pennant-mbl').value) || 0;
            const pennantPresent = document.querySelector('input[name="pennant-present"]:checked').value;
            
            const towlineShackleMBL = parseFloat(document.getElementById('towline-shackle-mbl').value) || 0;
            const bridleShackleMBL = parseFloat(document.getElementById('bridle-shackle-mbl').value) || 0;
            
            const fairleadMBL = parseFloat(document.getElementById('fairlead-mbl').value) || 0;
            const towConnectionMBL = parseFloat(document.getElementById('tow-connection-mbl').value) || 0;
            
            const bridleWeight = parseFloat(document.getElementById('bridle-weight').value) || 0;
            const recoveryWinch = parseFloat(document.getElementById('recovery-winch').value) || 0;
            const recoveryWireMBL = parseFloat(document.getElementById('recovery-wire-mbl').value) || 0;
            const recoveryShackleMBL = parseFloat(document.getElementById('recovery-shackle-mbl').value) || 0;
            
            const emergencyFairleadMBL = parseFloat(document.getElementById('emergency-fairlead-mbl').value) || 0;
            const emergencyConnectionMBL = parseFloat(document.getElementById('emergency-connection-mbl').value) || 0;
            const emergencyPennantMBL = parseFloat(document.getElementById('emergency-pennant-mbl').value) || 0;
            const emergencyPennantLength = parseFloat(document.getElementById('emergency-pennant-length').value) || 0;
            const extensionWireMBL = parseFloat(document.getElementById('extension-wire-mbl').value) || 0;
            const floatLineMBL = parseFloat(document.getElementById('float-line-mbl').value) || 0;
            const floatLineLength = parseFloat(document.getElementById('float-line-length').value) || 0;
            
            // Calculations based on Excel formulas
            
            // 1. Towline checks
            let requiredADL;
            if (towageType === "Benign") {
                requiredADL = Math.max(500, bollardPull / towlineMBL * 1200);
            } else if (towageType === "Normal") {
                requiredADL = Math.max(650, bollardPull / towlineMBL * 1800);
            } else {
                requiredADL = Math.max(500, bollardPull / towlineMBL * 1800);
            }
            
            let requiredTowlineMBL;
            if (deployableLength >= requiredADL) {
                if (bollardPull < 40) {
                    if (towageType === "Benign") {
                        requiredTowlineMBL = 2 * bollardPull;
                    } else {
                        requiredTowlineMBL = 3 * bollardPull;
                    }
                } else if (bollardPull > 100) {
                    requiredTowlineMBL = 2 * bollardPull;
                } else {
                    if (towageType === "Benign") {
                        requiredTowlineMBL = 2 * bollardPull;
                    } else {
                        requiredTowlineMBL = (220 - bollardPull) * bollardPull / 60;
                    }
                }
            } else {
                if (towageType === "Benign") {
                    requiredTowlineMBL = bollardPull / deployableLength * 1200;
                } else {
                    requiredTowlineMBL = bollardPull / deployableLength * 1800;
                }
            }
            
            // Update towline results
            document.getElementById('required-adl').textContent = requiredADL.toFixed(0) + " m";
            document.getElementById('actual-adl').textContent = deployableLength.toFixed(0) + " m";
            updateStatus('adl-status', deployableLength >= requiredADL);
            
            document.getElementById('required-towline-mbl').textContent = requiredTowlineMBL.toFixed(1) + " MT";
            document.getElementById('actual-towline-mbl').textContent = towlineMBL.toFixed(1) + " MT";
            updateStatus('towline-mbl-status', towlineMBL >= requiredTowlineMBL);
            
            // 2. Towing bridle checks
            let requiredBridleLegMBL;
            if (requiredTowlineMBL > 160) {
                requiredBridleLegMBL = requiredTowlineMBL + 40;
            } else {
                requiredBridleLegMBL = 1.25 * requiredTowlineMBL;
            }
            
            const requiredChafeChainMBL = requiredBridleLegMBL;
            const requiredBridleApexMBL = requiredBridleLegMBL;
            
            // Update towing bridle results
            document.getElementById('required-bridle-leg-mbl').textContent = requiredBridleLegMBL.toFixed(1) + " MT";
            document.getElementById('actual-bridle-leg-mbl').textContent = bridleLegMBL.toFixed(1) + " MT";
            updateStatus('bridle-leg-status', bridleLegMBL >= requiredBridleLegMBL);
            
            document.getElementById('required-chafe-chain-mbl').textContent = requiredChafeChainMBL.toFixed(1) + " MT";
            document.getElementById('actual-chafe-chain-mbl').textContent = chafeChainMBL.toFixed(1) + " MT";
            updateStatus('chafe-chain-status', chafeChainMBL >= requiredChafeChainMBL);
            
            document.getElementById('required-bridle-apex-mbl').textContent = requiredBridleApexMBL.toFixed(1) + " MT";
            document.getElementById('actual-bridle-apex-mbl').textContent = bridleApexMBL.toFixed(1) + " MT";
            updateStatus('bridle-apex-status', bridleApexMBL >= requiredBridleApexMBL);
            
            // 3. Intermediate wire pennant check
            const requiredPennantMBL = towlineMBL * 0.1 + requiredTowlineMBL;
            
            document.getElementById('required-pennant-mbl').textContent = requiredPennantMBL.toFixed(1) + " MT";
            document.getElementById('actual-pennant-mbl').textContent = pennantMBL.toFixed(1) + " MT";
            
            if (pennantPresent === "No") {
                updateStatus('pennant-status', true, "N/A");
            } else {
                updateStatus('pennant-status', pennantMBL >= requiredPennantMBL);
            }
            
            // 4. Shackles checks
            const requiredTowlineShackle = 1.3 * requiredTowlineMBL;
            const minBridleMBL = Math.min(requiredBridleLegMBL, requiredChafeChainMBL, requiredBridleApexMBL);
            const requiredBridleShackle = 1.3 * minBridleMBL;
            
            document.getElementById('required-towline-shackle').textContent = requiredTowlineShackle.toFixed(1) + " MT";
            document.getElementById('actual-towline-shackle').textContent = towlineShackleMBL.toFixed(1) + " MT";
            updateStatus('towline-shackle-status', towlineShackleMBL >= requiredTowlineShackle);
            
            document.getElementById('required-bridle-shackle').textContent = requiredBridleShackle.toFixed(1) + " MT";
            document.getElementById('actual-bridle-shackle').textContent = bridleShackleMBL.toFixed(1) + " MT";
            updateStatus('bridle-shackle-status', bridleShackleMBL >= requiredBridleShackle);
            
            // 5. Towline connections and fairleads check
            let requiredFairleadMBL;
            if (requiredTowlineMBL > 160) {
                requiredFairleadMBL = requiredTowlineMBL + 40;
            } else {
                requiredFairleadMBL = 1.25 * requiredTowlineMBL;
            }
            
            const requiredSmitBrackets = requiredFairleadMBL;
            
            document.getElementById('required-fairlead-mbl').textContent = requiredFairleadMBL.toFixed(1) + " MT";
            document.getElementById('actual-fairlead-mbl').textContent = fairleadMBL.toFixed(1) + " MT";
            updateStatus('fairlead-status', fairleadMBL >= requiredFairleadMBL);
            
            document.getElementById('required-smit-brackets').textContent = requiredSmitBrackets.toFixed(1) + " MT";
            document.getElementById('actual-smit-brackets').textContent = towConnectionMBL.toFixed(1) + " MT";
            updateStatus('smit-brackets-status', towConnectionMBL >= requiredSmitBrackets);
            
            // 6. Bridle recovery arrangement check
            const requiredRecoveryWinch = bridleWeight;
            const requiredRecoveryWire = 6 * bridleWeight;
            const requiredRecoveryShackle = 6 * bridleWeight;
            
            document.getElementById('required-recovery-winch').textContent = requiredRecoveryWinch.toFixed(2) + " MT";
            document.getElementById('actual-recovery-winch').textContent = recoveryWinch.toFixed(1) + " MT";
            updateStatus('recovery-winch-status', recoveryWinch >= requiredRecoveryWinch);
            
            document.getElementById('required-recovery-wire').textContent = requiredRecoveryWire.toFixed(1) + " MT";
            document.getElementById('actual-recovery-wire').textContent = recoveryWireMBL.toFixed(1) + " MT";
            updateStatus('recovery-wire-status', recoveryWireMBL >= requiredRecoveryWire);
            
            document.getElementById('required-recovery-shackle').textContent = requiredRecoveryShackle.toFixed(1) + " MT";
            document.getElementById('actual-recovery-shackle').textContent = recoveryShackleMBL.toFixed(1) + " MT";
            updateStatus('recovery-shackle-status', recoveryShackleMBL >= requiredRecoveryShackle);
            
            // 7. Emergency towing equipment check
            let requiredEmergencyFairlead;
            if (requiredTowlineMBL > 160) {
                requiredEmergencyFairlead = requiredTowlineMBL + 40;
            } else {
                requiredEmergencyFairlead = 1.25 * requiredTowlineMBL;
            }
            
            const requiredEmergencyConnection = requiredEmergencyFairlead;
            const requiredEmergencyPennantLength = 80;
            const requiredEmergencyPennantMBL = requiredEmergencyFairlead;
            const requiredExtensionWire = 25;
            const requiredFloatLine = 25;
            
            document.getElementById('required-emergency-fairlead').textContent = requiredEmergencyFairlead.toFixed(1) + " MT";
            document.getElementById('actual-emergency-fairlead').textContent = emergencyFairleadMBL.toFixed(1) + " MT";
            updateStatus('emergency-fairlead-status', emergencyFairleadMBL >= requiredEmergencyFairlead);
            
            document.getElementById('required-emergency-connection').textContent = requiredEmergencyConnection.toFixed(1) + " MT";
            document.getElementById('actual-emergency-connection').textContent = emergencyConnectionMBL.toFixed(1) + " MT";
            updateStatus('emergency-connection-status', emergencyConnectionMBL >= requiredEmergencyConnection);
            
            document.getElementById('required-emergency-pennant-length').textContent = requiredEmergencyPennantLength + " m";
            document.getElementById('actual-emergency-pennant-length').textContent = emergencyPennantLength + " m";
            updateStatus('emergency-pennant-length-status', emergencyPennantLength >= requiredEmergencyPennantLength);
            
            document.getElementById('required-emergency-pennant-mbl').textContent = requiredEmergencyPennantMBL.toFixed(1) + " MT";
            document.getElementById('actual-emergency-pennant-mbl').textContent = emergencyPennantMBL.toFixed(1) + " MT";
            updateStatus('emergency-pennant-status', emergencyPennantMBL >= requiredEmergencyPennantMBL);
            
            document.getElementById('required-extension-wire').textContent = requiredExtensionWire + " MT";
            document.getElementById('actual-extension-wire').textContent = extensionWireMBL.toFixed(1) + " MT";
            updateStatus('extension-wire-status', extensionWireMBL >= requiredExtensionWire);
            
            document.getElementById('required-float-line').textContent = requiredFloatLine + " MT";
            document.getElementById('actual-float-line').textContent = floatLineMBL.toFixed(1) + " MT";
            updateStatus('float-line-status', floatLineMBL >= requiredFloatLine);
            
            document.getElementById('required-float-line-length-range').textContent = "75-90 m";
            document.getElementById('actual-float-line-length').textContent = floatLineLength + " m";
            
            let floatLineLengthStatus;
            if (floatLineLength < 75) {
                floatLineLengthStatus = false;
            } else if (floatLineLength > 90) {
                floatLineLengthStatus = false;
            } else {
                floatLineLengthStatus = true;
            }
            updateStatus('float-line-length-status', floatLineLengthStatus);
            
            // Update overall status
            const allChecks = [
                deployableLength >= requiredADL,
                towlineMBL >= requiredTowlineMBL,
                bridleLegMBL >= requiredBridleLegMBL,
                chafeChainMBL >= requiredChafeChainMBL,
                bridleApexMBL >= requiredBridleApexMBL,
                (pennantPresent === "No" || pennantMBL >= requiredPennantMBL),
                towlineShackleMBL >= requiredTowlineShackle,
                bridleShackleMBL >= requiredBridleShackle,
                fairleadMBL >= requiredFairleadMBL,
                towConnectionMBL >= requiredSmitBrackets,
                recoveryWinch >= requiredRecoveryWinch,
                recoveryWireMBL >= requiredRecoveryWire,
                recoveryShackleMBL >= requiredRecoveryShackle,
                emergencyFairleadMBL >= requiredEmergencyFairlead,
                emergencyConnectionMBL >= requiredEmergencyConnection,
                emergencyPennantLength >= requiredEmergencyPennantLength,
                emergencyPennantMBL >= requiredEmergencyPennantMBL,
                extensionWireMBL >= requiredExtensionWire,
                floatLineMBL >= requiredFloatLine,
                floatLineLengthStatus
            ];
            
            const overallOk = allChecks.every(check => check === true);
            const overallStatus = document.getElementById('overall-status');
            
            if (overallOk) {
                overallStatus.textContent = "All design checks are satisfactory";
                overallStatus.style.color = "#2e7d32";
                sumstatus.textContent = "All requirements meet DNV-ST-N001 standards";
            } else {
                overallStatus.textContent = "Some design checks FAILED - Review results";
                overallStatus.style.color = "#c62828";
                sumstatus.textContent = "A redesign is recommended";
            }
        }
        
        function updateStatus(elementId, isOk, customText = null) {
            const element = document.getElementById(elementId);
            if (customText === "N/A") {
                element.textContent = "N/A";
                element.className = "status status-na";
            } else if (isOk) {
                element.textContent = "OK";
                element.className = "status status-ok";
            } else {
                element.textContent = "FAIL";
                element.className = "status status-fail";
            }
        }
        
        // Create simple towing bridle diagram
        function createTowingDiagram() {
            const diagram = document.querySelector('.towing-diagram');
            if (!diagram) return;
            
            // Clear any existing content
            diagram.innerHTML = '';
            
            // Create a simple SVG representation
            const svgNS = "http://www.w3.org/2000/svg";
            const svg = document.createElementNS(svgNS, "svg");
            svg.setAttribute("width", "100%");
            svg.setAttribute("height", "100%");
            svg.setAttribute("viewBox", "0 0 400 200");
            
            // Draw towing bridle shape
            // Tug
            const tug = document.createElementNS(svgNS, "rect");
            tug.setAttribute("x", "50");
            tug.setAttribute("y", "80");
            tug.setAttribute("width", "60");
            tug.setAttribute("height", "40");
            tug.setAttribute("fill", "#2a6f98");
            tug.setAttribute("stroke", "#1a5f8c");
            tug.setAttribute("stroke-width", "2");
            svg.appendChild(tug);
            
            // Towline
            const towline = document.createElementNS(svgNS, "line");
            towline.setAttribute("x1", "110");
            towline.setAttribute("y1", "100");
            towline.setAttribute("x2", "200");
            towline.setAttribute("y2", "100");
            towline.setAttribute("stroke", "#666");
            towline.setAttribute("stroke-width", "3");
            svg.appendChild(towline);
            
            // Bridle apex
            const apex = document.createElementNS(svgNS, "circle");
            apex.setAttribute("cx", "200");
            apex.setAttribute("cy", "100");
            apex.setAttribute("r", "8");
            apex.setAttribute("fill", "#ff9800");
            apex.setAttribute("stroke", "#f57c00");
            apex.setAttribute("stroke-width", "2");
            svg.appendChild(apex);
            
            // Bridle legs
            const bridleLeg1 = document.createElementNS(svgNS, "line");
            bridleLeg1.setAttribute("x1", "200");
            bridleLeg1.setAttribute("y1", "100");
            bridleLeg1.setAttribute("x2", "250");
            bridleLeg1.setAttribute("y2", "50");
            bridleLeg1.setAttribute("stroke", "#666");
            bridleLeg1.setAttribute("stroke-width", "3");
            svg.appendChild(bridleLeg1);
            
            const bridleLeg2 = document.createElementNS(svgNS, "line");
            bridleLeg2.setAttribute("x1", "200");
            bridleLeg2.setAttribute("y1", "100");
            bridleLeg2.setAttribute("x2", "250");
            bridleLeg2.setAttribute("y2", "150");
            bridleLeg2.setAttribute("stroke", "#666");
            bridleLeg2.setAttribute("stroke-width", "3");
            svg.appendChild(bridleLeg2);
            
            // Tow connection points
            const connection1 = document.createElementNS(svgNS, "circle");
            connection1.setAttribute("cx", "250");
            connection1.setAttribute("cy", "50");
            connection1.setAttribute("r", "6");
            connection1.setAttribute("fill", "#4caf50");
            connection1.setAttribute("stroke", "#388e3c");
            connection1.setAttribute("stroke-width", "2");
            svg.appendChild(connection1);
            
            const connection2 = document.createElementNS(svgNS, "circle");
            connection2.setAttribute("cx", "250");
            connection2.setAttribute("cy", "150");
            connection2.setAttribute("r", "6");
            connection2.setAttribute("fill", "#4caf50");
            connection2.setAttribute("stroke", "#388e3c");
            connection2.setAttribute("stroke-width", "2");
            svg.appendChild(connection2);
            
            // Labels
            const labelTug = document.createElementNS(svgNS, "text");
            labelTug.setAttribute("x", "80");
            labelTug.setAttribute("y", "75");
            labelTug.setAttribute("text-anchor", "middle");
            labelTug.setAttribute("fill", "#333");
            labelTug.setAttribute("font-size", "12");
            labelTug.setAttribute("font-weight", "bold");
            labelTug.textContent = "Tug";
            svg.appendChild(labelTug);
            
            const labelApex = document.createElementNS(svgNS, "text");
            labelApex.setAttribute("x", "200");
            labelApex.setAttribute("y", "85");
            labelApex.setAttribute("text-anchor", "middle");
            labelApex.setAttribute("fill", "#333");
            labelApex.setAttribute("font-size", "10");
            labelApex.textContent = "Apex";
            svg.appendChild(labelApex);
            
            const labelConnection = document.createElementNS(svgNS, "text");
            labelConnection.setAttribute("x", "300");
            labelConnection.setAttribute("y", "100");
            labelConnection.setAttribute("text-anchor", "middle");
            labelConnection.setAttribute("fill", "#333");
            labelConnection.setAttribute("font-size", "12");
            labelConnection.setAttribute("font-weight", "bold");
            labelConnection.textContent = "Tow Connections";
            svg.appendChild(labelConnection);
            
            diagram.appendChild(svg);
        }
        
        // Initialize diagram
        setTimeout(createTowingDiagram, 100);
    </script>
</body>
</html>
